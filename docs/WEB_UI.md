# Web UI для Тестирования

## Обзор

Vanilla JavaScript UI для тестирования всех возможностей микросервиса обработки изображений. Интерфейс доступен по корневому пути сервиса (`http://localhost:8084/` в dev режиме).

## Технологии

- **HTML5** - семантическая разметка
- **Vanilla CSS** - современный дизайн с градиентами и анимациями
- **Vanilla JavaScript** - без фреймворков, чистый ES6+
- **@fastify/static** - раздача статических файлов через Fastify

## Структура

```
public/
├── index.html    # Основная разметка
├── styles.css    # Стили с премиум дизайном
└── app.js        # Логика приложения
```

## Возможности

### 1. Process Image Tab

Полный набор параметров для обработки изображений:

#### Приоритет задачи
- High (0) - высокий приоритет
- Medium (1) - средний приоритет
- Low (2) - низкий приоритет (по умолчанию)

#### Трансформации

**Auto Orient**
- Автоматический поворот и отзеркаливание на основе EXIF данных
- Включено по умолчанию

**Resize (Изменение размера)**
- Width/Height - явное указание размеров
- Max Dimension - ограничение большей стороны
- Fit Mode: inside, cover, contain, fill, outside
- Position: center, top, right, bottom, left, entropy, attention
- Without Enlargement - не увеличивать изображение

**Crop (Обрезка)**
- Left, Top - координаты начала обрезки
- Width, Height - размеры области обрезки

**Rotate & Flip**
- Rotate - поворот на угол (-360 до 360 градусов)
- Flip - отзеркаливание по вертикали
- Flop - отзеркаливание по горизонтали

**Background Color**
- Цвет фона для удаления прозрачности
- Поддержка hex (#ffffff) и названий цветов (white)

#### Выходной формат

**Основные параметры**
- Format: WebP, AVIF, JPEG, PNG, GIF, TIFF
- Quality (1-100) - качество сжатия
- Lossless - сжатие без потерь (WebP/AVIF)
- Strip Metadata - удалить метаданные

**Продвинутые параметры**
- Effort (0-9) - уровень усилий при сжатии
- Compression Level (0-9) - уровень сжатия для PNG
- Chroma Subsampling (4:2:0, 4:4:4) - для AVIF и JPEG
- Progressive - прогрессивная развертка для JPEG
- MozJPEG - использовать библиотеку mozjpeg
- Palette - квантование палитры для PNG
- Colors (2-256) - количество цветов в палитре
- Dither (0.0-1.0) - диффузия ошибок Floyd-Steinberg
- Adaptive Filtering - адаптивная фильтрация для PNG

#### Результаты обработки

После обработки отображается:
- Обработанное изображение
- Формат выходного файла
- Размеры (width × height)
- Размер файла
- Оригинальный размер
- Процент уменьшения размера
- Кнопки Download и Process Another

### 2. Extract EXIF Tab

Извлечение метаданных из изображений:

- Приоритет задачи (High/Medium/Low)
- Отображение всех EXIF данных в JSON формате
- Информация о камере, настройках съемки, дате и времени

### 3. Health Status

В шапке отображается:
- Статус сервиса (Online/Offline)
- Размер очереди задач
- Количество задач в обработке
- Автоматическое обновление каждые 30 секунд

## Особенности UI

### Дизайн

- **Современный премиум дизайн** с градиентами и тенями
- **Адаптивная верстка** для всех устройств
- **Плавные анимации** и переходы
- **Интерактивные элементы** с hover эффектами
- **Цветовая схема** на основе HSL для гармоничных цветов
- **Типографика** с использованием Inter font

### UX

- **Drag & Drop** для загрузки изображений
- **Аккордеоны** для группировки параметров
- **Превью** оригинального и обработанного изображения
- **Валидация** параметров на стороне клиента
- **Toast уведомления** об успехе/ошибках
- **Loading overlay** во время обработки
- **Автоматическая очистка** форм после обработки

### Доступность

- Семантическая HTML разметка
- Правильная структура заголовков
- Описательные aria-labels
- Keyboard navigation support

## API Integration

UI взаимодействует с тремя эндпоинтами:

1. **GET /api/v1/health** - проверка статуса сервиса
2. **POST /api/v1/process** - обработка изображений
3. **POST /api/v1/exif** - извлечение EXIF данных

Все запросы используют JSON формат с Base64 кодированием изображений.

## Разработка

### Добавление новых параметров

1. Добавить поле в `index.html`
2. Обновить функцию `buildTransformObject()` или `buildOutputObject()` в `app.js`
3. Убедиться, что параметр поддерживается бэкендом

### Стилизация

Все CSS переменные определены в `:root` в `styles.css`:
- Цвета (primary, secondary, success, warning, danger)
- Фоны (bg-primary, bg-secondary, bg-tertiary)
- Текст (text-primary, text-secondary, text-tertiary)
- Границы (border, border-hover)
- Тени (shadow-sm, shadow-md, shadow-lg, shadow-xl)
- Радиусы (radius-sm, radius-md, radius-lg, radius-xl)

### Отладка

Откройте DevTools браузера для:
- Просмотра console.log сообщений
- Проверки Network запросов к API
- Отладки JavaScript кода
- Инспекции DOM элементов

## Производительность

- **Минимальные зависимости** - только vanilla JS
- **Оптимизированные изображения** - Base64 кодирование только при необходимости
- **Ленивая загрузка** - аккордеоны раскрываются по требованию
- **Debouncing** - для health check запросов

## Безопасность

- **Валидация на клиенте** - проверка типов файлов
- **Ограничение размера** - соответствует настройкам сервера
- **XSS защита** - использование textContent вместо innerHTML где возможно
- **CORS** - настроен на стороне сервера

## Будущие улучшения

- [ ] Поддержка пакетной обработки
- [ ] История обработанных изображений
- [ ] Сохранение пресетов параметров
- [ ] Сравнение до/после side-by-side
- [ ] Поддержка темной темы
- [ ] Интернационализация (i18n)
